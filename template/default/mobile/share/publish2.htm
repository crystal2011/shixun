{template 'header','mobile'}
<script type="text/javascript" src="<?php echo DT_STATIC;?>lang/<?php echo DT_LANG;?>/lang.js"></script>
<script type="text/javascript" src="<?php echo DT_STATIC;?>file/script/config.js"></script>
<script type="text/javascript" src="<?php echo DT_STATIC;?>file/script/common.js"></script>
<script type="text/javascript" src="<?php echo DT_STATIC;?>file/script/admin.js"></script>
<header>
    <article  id="header1" class="clear">
        <a class="forback fl" href="{$forward}"><img src="{DT_SKIN}image/mobile/leftpoint.png" />{$topname}</span></a>
    </article>
</header>
<section class="publishform">
    <article>
        <form id="publishform" method="post" action="/share/publish.php?isajax=1">
            <div class="h3h">基本选项</div>
            {template  'publishcommon','mobile/share'}
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>职位</span>
                <span class="publishright">
                    <input type="text" name="title" value="<?php echo isset($info['title'])?$info['title']:''; ?>" maxlength="50" datatype="*2-50" placeholder="名称" class="input-text" />
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>分类选择</span>
                <span class="publishright">
                    {ajax_category_select('catid', '选择分类', isset($info['catid'])?$info['catid']:0, 9,'class="input-text smallinput"')}
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>公司名称</span>
                <span class="publishright">
                    <input type="text" class="input-text" name="company" value="<?php echo isset($info['company'])?$info['company']:'' ?>" type="text" datatype="*2-50" placeholder="公司"/>
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>招聘人数</span>
                <span class="publishright">
                    <input type="text" class="input-text smallinput" name="total" value="<?php echo isset($info['total'])?$info['total']:'' ?>" type="text" datatype="n1-4" placeholder="填0为若干"/> [填0为若干]
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>职位月薪</span>
                <span class="publishright">
                    <input type="text" class="input-text smallinput" value="<?php echo isset($info['minsalary'])?$info['minsalary']:'' ?>" name="minsalary" type="text" datatype="n1-8" placeholder="1000"/> -
                    <input style="width:100px;" class="input-text smallinput" value="<?php echo isset($info['maxsalary'])?$info['maxsalary']:'' ?>" name="maxsalary" type="text" datatype="n1-8" placeholder="9000"/>
                    [填0为面议]<span class="Validform_checktip"></span>
                    <br />

                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>工作性质</span>
                <span class="publishright">
                    <select name="type" datatype="*" class="input-text smallinput">
                        {loop $aSetting9['type'] $k $v}
                        <option value="{$k}" <?php echo isset($info['type']) && $info['type']==$k?'selected':'' ?> >{$v}</option>
                        {/loop}
                    </select>
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>学历要求</span>
                <span class="publishright">
                    <select name="education" datatype="*" class="input-text smallinput">
                        {loop $aSetting9['education'] $k $v}
                        <option value="{$k}" <?php echo isset($info['education']) && $info['education']==$k?'selected':'' ?>>{$v}</option>
                        {/loop}
                    </select>
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>工作经验</span>
                <span class="publishright">
                    <select name="experience" datatype="*" class="input-text smallinput">
                        <option value="0">不限</option>
                        <?php for($i = 1; $i < 21; $i++) { ?>
                        <option value="<?php echo $i;?>" <?php echo isset($info['experience']) && $info['experience']==$i?'selected':''; ?>><?php echo $i;?></option>
                        <?php } ?>
                    </select>&nbsp;&nbsp;年以上
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <br />
            <div class="h3h">联系方式</div>
            <p class="clearfix">
                <span class="publishleft">电话</span>
                <span class="publishright">
                    <input type="text" class="input-text" name="mobile" value="<?php echo isset($info['phone'])?$info['phone']:(isset($info['telephone'])?$info['telephone']:'') ?>" maxlength="15"  placeholder="134****3456/020-0000111"/>
                </span>
                <br />
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>地区</span>
                <span class="publishright">
                    {ajax_area_select('areaid', '请选择', isset($info['areaid'])?$info['areaid']:0,'isarea="1" class="input-text smallinput"')}
                    <br />
                    <span class="Validform_checktip"></span>
                </span>
            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red">*</i>地址</span>
                <span class="publishright">
                    <input datatype="*3-50" maxlength="50" value="<?php echo isset($info['address'])?$info['address']:'' ?>" class="input-text" name="address" type="text" placeholder="详细地址"/>
                    <br />
                    <span class="Validform_checktip"></span>
                </span>

            </p>
            <p class="clearfix">
                <span class="publishleft"><i class="red"></i>详细内容</span>
                <span class="publishright">
                    <textarea class="input-text textinput" name="content" id="content"><?php echo isset($info['content'])?$info['content']:'' ?></textarea>
                </span>
            </p>
            <div class="btn-box">
                <input  type="hidden" name="submit" value="2"/>
                <input  type="hidden" name="itemid" value="<?php echo $itemid ?>"/>
                <input  type="hidden" name="beforeurl" value="<?php echo $forward; ?>"/>
                <input type="hidden" name="moduleidtype" value="2" />
                <input style="background:#ea5550;margin-left:150px;border:1px solid #f1f1f1;color:#fff;padding:10px 25px;border-radius:5px;margin-top:10px;font-size:1.4em;" type="submit" value="提交"/>
            </div>
        </form>
    </article>
</section>
<script src="{DT_SKIN}js/jquery-1.9.1.min.js"></script>
<script src="{DT_SKIN}js/Validform_v5.3.2_min.js"></script>
<script>
    $("#publishform").Validform({
        tiptype: 3,
        postonce:true,
        ajaxPost:true,
        datatype:{
            "mobile":function(gets,obj,curform,regxp){
                if(!is_mobile(gets) && !is_phone(gets)) return '输入错误';
                return true;
            },
            'money':function(gets,obj,curform,regxp){
                if(!is_price(gets)) return false;
                return true;
            },
            'empty':function(gets,obj,curform,regxp){
                if(gets.length==0) return true;
                return false;
            }
        },
        beforeCheck:function(curform){
            var isnotselect = true;
            var dn = 0;
            $("#publishform select").each(function(){
                var selvel = $(this).val();
                if($(this).attr("isarea")==1 && selvel!=0){
                    dn = dn+1;
                }

                if(selvel==0 && !($(this).attr("isarea")==1 && dn>=2)){
                    isnotselect = false;
                    $(this).parent().parent().find('.Validform_checktip').removeClass('Validform_right').addClass('Validform_wrong').html('请选择');
                    $(this).focus();
                    return false;
                }
            })
            if(!isnotselect) return false;
            return true;
        },
        beforeSubmit:function(curform){
            getToken();
            return true;
        },
        callback:function(data){
            layer.open({
                content: data.info,
                title:'提示'
            });
            if(data.status=='y'){
                window.setTimeout("locationhref('"+data.url+"')",1000);
            }
        }
    })
    $(document).on("change","select",function(){
        $(this).parent().parent().find('.Validform_checktip').removeClass('Validform_wrong').html('');
    })
    function locationhref(url){
        if(url!='aa'){
            location.href = url;
        }else{
            location.reload();
        }
    }
</script>